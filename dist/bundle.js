(()=>{"use strict";var t,e=(t=function(e,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},t(e,o)},function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}),o=function(){function t(e){this.color="rgb(255, 255, 255)",this.coordinates=e,this.center={x:this.coordinates.x+t.width/2,y:this.coordinates.y+t.height/2}}return t.prototype.draw=function(){t.ctx.fillStyle=this.color,t.ctx.fillRect(this.coordinates.x,this.coordinates.y,t.height,t.width)},t.height=10,t.width=10,t}(),i=function(t){function i(e){var o=t.call(this,e)||this;return o.color="rgb(".concat(Math.floor(256*Math.random()),", ").concat(Math.floor(256*Math.random()),", ").concat(Math.floor(256*Math.random()),")"),o}return e(i,t),i.prototype.draw=function(){o.ctx.fillStyle=this.color,o.ctx.beginPath(),o.ctx.rect(this.coordinates.x-2,this.coordinates.y,8,4),o.ctx.fill(),o.ctx.rect(this.coordinates.x,this.coordinates.y-2,4,8),o.ctx.fill(),o.ctx.closePath()},i}(o),n=function(){var t=function(e,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},t(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),r=.9*window.innerHeight,h=.9*window.innerWidth,c=function(){function t(){}return t.setHead=function(e){t.head=e,t.body[0]=e},t.addBody=function(e){if(t.getSize()<1)throw new Error("Snake body parts can only be added after the snake head");t.body.push(e)},t.getSize=function(){return t.body.length},t.getScore=function(){return t.body.length-5},t.setColors=function(e){t.body.forEach((function(t){t.setColor(e)}))},t.body=[],t.tailMode=!1,t}(),s=function(){function t(e,o){void 0===o&&(o="rgb(0, 207, 151)"),this.coordinates=e,this.x=e.x,this.y=e.y,this.center={x:this.x+t.width/2,y:this.y+t.height/2},this.color=o,this.movementDirection={x:0,y:-1}}return t.prototype.draw=function(){c.ctx.fillStyle=this.color,c.ctx.fillRect(this.x,this.y,t.height,t.width)},t.prototype.move=function(){this.x=this.x+this.movementDirection.x*t.velocity,this.y=this.y+this.movementDirection.y*t.velocity,this.coordinates={x:this.x,y:this.y},this.center={x:this.x+t.width/2,y:this.y+t.height/2},this.draw()},t.prototype.goTo=function(e){this.coordinates=e,this.x=e.x,this.y=e.y,this.center={x:this.x+t.width/2,y:this.y+t.height/2},this.draw()},t.prototype.setColor=function(t){this.color=t,c.ctx.fillStyle=t},t.height=16,t.width=16,t.velocity=8,t}(),a=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e}(s),d=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.draw=function(){c.ctx.fillStyle=this.color,c.ctx.fillRect(this.x,this.y,s.height,s.width),c.ctx.fillStyle="black",c.ctx.fillRect(this.x+5,this.y+5,6,4)},e.prototype.die=function(){c.ctx.fillStyle=this.color,c.ctx.fillRect(this.x,this.y,s.height,s.width),c.ctx.beginPath(),c.ctx.strokeStyle="black",c.ctx.moveTo(this.x+5,this.y+5),c.ctx.lineTo(this.x+10,this.y+10),c.ctx.moveTo(this.x+10,this.y+5),c.ctx.lineTo(this.x+5,this.y+10),c.ctx.lineWidth=2,c.ctx.stroke()},e.prototype.distanceOfWall=function(){return{x:this.x>=h/2?h-this.x:this.x+s.width,y:this.y>=r/2?r-this.y:this.y+s.height}},e.prototype.distanceLesserThan=function(t,e){void 0===e&&(e=16);var o=this.center.x-t.x>=0?this.center.x-t.x:t.x-this.center.x,i=this.center.y-t.y>=0?this.center.y-t.y:t.y-this.center.y;return o<e&&i<e},e.prototype.setMovement=function(t){1!==t.x&&-1!==t.x||0===this.movementDirection.x&&(this.movementDirection=t),1!==t.y&&-1!==t.y||0===this.movementDirection.y&&(this.movementDirection=t)},e}(s),y=document.getElementById("canvas"),l=y.getContext("2d"),x=document.getElementById("score"),f=!0,u=!1,p=0;function w(){o.ctx=l,c.ctx=l,c.body=[],c.setHead(new d({x:y.width/2,y:y.height/2}));for(var t=0;t<4;t++)c.addBody(new a({x:y.width/2,y:y.height/2}));for(o.pellet=new i({x:.1*y.width+Math.random()*y.width*.8,y:.1*y.height+Math.random()*y.height*.8}),t=c.body.length-1;t>0;t--)c.body[t].goTo({x:c.body[t-1].x,y:c.body[t-1].y})}function g(){var t=0,e=0;x.innerText=c.getScore().toString(),window.requestAnimationFrame((function n(){if(f&&!u){if(t+=1,p>0&&(p-=1),l.clearRect(0,0,y.width,y.height),c.tailMode&&t%15-Math.round(.2*c.getSize())==0){e+=1;for(var r=1;r<e;r++)c.body[c.getSize()-r].setColor("red");e>c.getSize()&&(u=!0)}for(r=c.body.length-1;r>0;r--)c.body[r].goTo({x:c.body[r-1].x,y:c.body[r-1].y}),r>4&&c.head.distanceLesserThan(c.body[r].center,10)&&(u=!0);o.pellet.draw(),c.head.move();var h=c.head.distanceOfWall();(h.x<=20||h.y<=20)&&(u=!0),c.head.distanceLesserThan(o.pellet.center)&&(c.addBody(new a({x:-1e3,y:-1e3})),c.setColors(o.pellet.color),y.style.borderColor=o.pellet.color,x.innerText=c.getScore().toString(),c.getScore()>=15&&(c.tailMode=!0,e=0),o.pellet=new i({x:Math.floor(.1*y.width+Math.random()*y.width*.8),y:Math.floor(.1*y.height+Math.random()*y.height*.8)}))}if(u)return e=0,f=!1,c.tailMode=!1,void c.head.die();window.requestAnimationFrame(n)}))}y.height=.9*window.innerHeight,y.width=.9*window.innerWidth,w(),document.addEventListener("keydown",(function(t){if(!(p>0)){var e=t.key.toUpperCase();switch(p+=3,e){case"D":case"ARROWRIGHT":c.head.setMovement({x:1,y:0});break;case"W":case"ARROWUP":c.head.setMovement({x:0,y:-1});break;case"A":case"ARROWLEFT":c.head.setMovement({x:-1,y:0});break;case"S":case"ARROWDOWN":c.head.setMovement({x:0,y:1});break;case"P":f=!1;break;case"C":f=!0,g();break;case"R":w(),f=!0,u=!1,g()}}})),g()})();